#define nValue 100
#define SensorPin 15  //A1

int readings[nValue];
byte readIndex = 0;
int total = 0;
int average = 0;

void setup() {
  while (!Serial) {}
  Serial.begin(115200);

  for (int thisReading = 0; thisReading < nValue; thisReading++) {
    readings[thisReading] = 0;
  }
}

void SMA () {
  total -= readings[readIndex];   //subtract old reading from total
  readings[readIndex] = analogRead(SensorPin);;   //place new reading into the array
  total += readings[readIndex];   //add the new reading to the total
  readIndex += 1;   //move up to the next array position

  if (readIndex >= nValue) {  //once we reach the end of the array
    readIndex = 0;            //start over form the first position
  }

  average = total / nValue;   //take the current average
}

void loop() {
  
  SMA();    // Call to run the "Simple Moving Average" action
  
  Serial.print(average);
  Serial.print(" , ");
  Serial.println(analogRead(SensorPin));
}
